<div>
  <div class="my-4">
    <h2 class="text-2xl text-start font-bold">Anexar Documento</h2>
    <p class="text-black text-start text-sm mt-1">
      Documentos com fotos aceitos: Passaporte, Identidade e CNH.
    </p>
    <p class="text-black text-start text-sm mt-1 md:text-start">
      Para <span class="font-bold">menores de até 12 anos</span>, anexe a certidão de nascimento.
    </p>
  </div>

  <div class="bg-white rounded-xl shadow-lg p-6 h-auto flex flex-col justify-center items-center gap-4">

    <!-- If document already sent -->
    <div *ngIf="fileUploaded" class="text-center">
      <p class="text-green-600 font-medium text-sm">Documento já enviado!</p>
    </div>

    <!-- Upload Area -->
    <ng-container *ngIf="!fileUploaded && !imagePreview">
      <div
        class="flex flex-col items-center justify-center w-full h-40 border-2 border-dashed rounded-lg border-gray-400 bg-gray-50 opacity-50 cursor-pointer"
        (click)="fileInput.click()"
      >
        <img src="exit.png" alt="Upload Icon" class="w-9 h-9 mb-2"/>

        <span class="text-gray-600 text-sm font-medium text-center" *ngIf="isViewMode">
          Usuário administrador — envio de documento desabilitado.
        </span>
        
        <span class="text-gray-600 text-sm font-medium text-center p-5" *ngIf="!isViewMode">
          Clique para selecionar o documento aqui
        </span>

        <input
          #fileInput
          type="file"
          accept=".pdf,image/*"
          class="hidden disabled:bg-gray-200 disabled:text-gray-500"
          [disabled]="isViewMode"
          (change)="onFileSelected($event)"
        />
      </div>
    </ng-container>

    <!-- Preview -->
    <div *ngIf="imagePreview && !fileUploaded" class="mt-4 w-full flex flex-col items-center">
    
      <ng-container *ngIf="!isPdf">
          <img [src]="imagePreview" alt="Pré-visualização do Documento" class="flex flex-col items-center justify-center max-h-40 w-full rounded-lg border-2 border-dashed border-gray-300 bg-gray-50 p-4"/>
      </ng-container>

      <ng-container *ngIf="isPdf">
          <div class="flex flex-col items-center justify-center h-40 w-full rounded-lg border-2 border-dashed border-gray-300 bg-gray-50 p-4">
            <svg class="w-10 h-10 text-red-500" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112.586 2.414L16 5.828A2 2 0 0116 7.242V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 10a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1-5a1 1 0 100 2h6a1 1 0 100-2H7z" clip-rule="evenodd"></path>
            </svg>
            <p class="text-gray-700 text-sm font-medium mt-2 text-center break-words">
                Arquivo PDF selecionado: <br>**{{ fileToUpload?.name }}**
            </p>
          </div>
      </ng-container>

      <p class="text-xs text-gray-500 mt-2">Pré-visualização do documento</p>

      <app-button
          *ngIf="fileToUpload"
          type="button"
          (click)="sendImage()"
          class="mt-4 w-full"
      >
          Enviar Documento
      </app-button>

      <button class="w-full bg-yellow-400 text-white text-sm mt-2 py-2 px-4 rounded-lg font-semibold cursor-pointer hover:bg-yellow-500 transition"
          type="button" (click)="resetUpload()">
          Enviar outro documento
      </button>
    </div>
  </div>
</div>
